# Calculating the correlation between raw.temp and registered users and between raw.temp and causal users
cor.reg <- cor.test(x = day$raw.temp, y = day$registered)
cor.reg
# Adding Correlation line and the correlation value to the plot
abline(lm(day$registered ~ day$raw.temp), lty = 6, col = "blue")
abline(lm(day$casual ~ day$raw.temp), lty = 6, col = "orange")
reg <- paste("cor = ", round(cor(day$registered, day$raw.temp), 2), sep = "")
cas <- paste("cor = ", round(cor(day$casual, day$raw.temp), 2), sep = "")
legend("left",legend = c(cas, reg) , col = c('orange', 'blue'),pch = c(16, 16), bg = "white")
# Calculating the correlation between raw.temp and registered users
cor.reg <- cor.test(x = day$raw.temp, y = day$registered)
cor.reg
# Calculating the correlation between raw.temp and causal users
cor.cas <- cor.test(x = day$raw.temp,
y = day$casual)
cor.cas
#Calculating min and max
min(day$raw.temp)
max(day$raw.temp)
min(day$casual)
max(day$casual)
min(day$registered)
max(day$registered)
# Plotting the association:
plot(x = 1, y = 1, xlab = "Temperature in Celcius", ylab = "Bike rentals", type = "n", main = "Association between temperature and bike rentals",
xlim = c(0, 40), ylim = c(0, 7000))
#Adding points to the plot
day$raw.temp <- (day$temp*41)
points(day$raw.temp, day$casual, pch = 16, col = "red")
points(day$raw.temp, day$registered, pch = 16, col = "skyblue")
# Adding a legend to the plot
legend("topleft",legend = c("casual", "registered"), col = c("red","skyblue"), pch = c(16, 16), bg = "white")
# Calculating the correlation between raw.temp and registered users and between raw.temp and causal users
cor.reg <- cor.test(x = day$raw.temp, y = day$registered)
cor.reg
# Adding Correlation line and the correlation value to the plot
abline(lm(day$registered ~ day$raw.temp), lty = 6, col = "blue")
abline(lm(day$casual ~ day$raw.temp), lty = 6, col = "orange")
reg <- paste("cor = ", round(cor(day$registered, day$raw.temp), 2), sep = "")
cas <- paste("cor = ", round(cor(day$casual, day$raw.temp), 2), sep = "")
legend("left",legend = c(cas, reg) , col = c('orange', 'blue'),pch = c(16, 16), bg = "white")
# Plotting the association:
plot(x = 1, y = 1, xlab = "Temperature in Celcius", ylab = "Bike rentals", type = "n", main = "Association between temperature and bike rentals",
xlim = c(0, 40), ylim = c(0, 7000))
#Adding points to the plot
day$raw.temp <- (day$temp*41)
points(day$raw.temp, day$casual, pch = 16, col = "red")
points(day$raw.temp, day$registered, pch = 16, col = "skyblue")
# Adding a legend to the plot
legend("topleft",legend = c("casual", "registered"), col = c("red","skyblue"), pch = c(16, 16), bg = "white")
# Calculating the correlation between raw.temp and registered users and between raw.temp and causal users
cor.reg <- cor.test(x = day$raw.temp, y = day$registered)
cor.reg
# Adding Correlation line and the correlation value to the plot
abline(lm(day$registered ~ day$raw.temp), lty = 6, col = "blue")
abline(lm(day$casual ~ day$raw.temp), lty = 6, col = "orange")
reg <- paste("cor = ", round(cor(day$registered, day$raw.temp), 2), sep = "")
cas <- paste("cor = ", round(cor(day$casual, day$raw.temp), 2), sep = "")
legend("left",legend = c(cas, reg) , col = c('orange', 'blue'),pch = c(16, 16), bg = "white")
library(FactoMineR)
library(ggplot2)
library(ggrepel)
TT_occ_q = read.csv("data/TT_csv/TT_occ_q.csv")
head(TT_occ_q)
TT_occ_q_t = t(TT_occ_q)
TT_occ_q = read.csv("data/TT_csv/TT_occ_q.csv")
TT_occ_q = read.csv("data/TT_csv/TT_occ_q.csv")
TT_occ_q = read.csv("data/TT_csv/TT_occ_q.csv")
head(TT_occ_q)
TT_occ_q_t = t(TT_occ_q)
res.ca = CA(TT_occ_q_t)
mat_terms_contrib = as.data.frame(res.ca$col$contrib) #contribution de chaque thématique
mat_terms_contrib_order = mat_terms_contrib[order(-mat_terms_contrib$`Dim 1`,-mat_terms_contrib$`Dim 2`,
-mat_terms_contrib$`Dim 3`),]  #ordre décroissant des contributions
TT_occ_q = read.csv("data/TT_csv/TT_occ_q.csv")
head(TT_occ_q)
TT_occ_q_t = t(TT_occ_q)
res.ca = CA(TT_occ_q_t)
mat_terms_contrib = as.data.frame(res.ca$col$contrib) #contribution de chaque thématique
mat_terms_contrib_order = mat_terms_contrib[order(-mat_terms_contrib$`Dim 1`,-mat_terms_contrib$`Dim 2`,
-mat_terms_contrib$`Dim 3`),]  #ordre décroissant des contributions
library(FactoMineR)
library(ggplot2)
library(ggrepel)
TT_occ_q = read.csv("data/TT_csv/TT_occ_q.csv")
TT_occ_q = read.csv("data/TT_csv/TT_occ_q.csv")
library(FactoMineR)
library(ggplot2)
library(ggrepel)
#data
TT_occ_a = read.csv("TT_occ_a.csv")
setwd("E:/M2_MLDS_FA/PPD/mixkmeans/AFC")
#data
TT_occ_a = read.csv("TT_occ_a.csv")
mat_terms_contrib = as.data.frame(res.ca$col$contrib) #contribution de chaque therme
#AFC
res.ca = CA(TT_occ_a, ncp = 4)
mat_terms_contrib = as.data.frame(res.ca$col$contrib) #contribution de chaque therme
mat_terms_contrib_order = mat_terms_contrib[order(-mat_terms_contrib$`Dim 1`,-mat_terms_contrib$`Dim 2`,
-mat_terms_contrib$`Dim 3`),]  #ordre décroissant des contributions
mat_terms_contrib
mat_terms_contrib_order
n_top_terms = 20
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms], order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
n_top_terms = 10
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms], order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
n_top_terms = 15
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms], order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
n_top_terms = 20
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms], order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
n_top_terms = 15
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms], order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
#data
TT_tfidf_q = read.csv("TT_tfidf_q.csv")
res.ca = CA(TT_tfidf_q, ncp = 4, graph = FALSE)
mat_terms_contrib = as.data.frame(res.ca$col$contrib) #contribution de chaque thématique
mat_terms_contrib_order = mat_terms_contrib[order(-mat_terms_contrib$`Dim 1`,-mat_terms_contrib$`Dim 2`,
-mat_terms_contrib$`Dim 3`),]  #ordre décroissant des contributions
n_top_terms = 20
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms], order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
n_top_terms = 5
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms], order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
#data
TT_tfidf_a = read.csv("TT_tfidf_a.csv")
TT_tfidf_a
TT_tfidf_a = read.csv("TT_tfidf_a.csv")
#contribution of any therm
mat_terms_contrib = as.data.frame(res.ca$col$contrib)
mat_terms_contrib_order = mat_terms_contrib[order(-mat_terms_contrib$`Dim 1`,
-mat_terms_contrib$`Dim 2`,
-mat_terms_contrib$`Dim 3`),]
n_top_terms = 20
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms], order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
n_top_terms = 10
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms], order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
plot(mat_coord_col_top)
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
points(mat_coord_row_, col= 'red')
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
points(mat_coord_row_, col= 'red')
n_top_terms = 20
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
#plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
#points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
#data
TT_occ_q = read.csv("TT_occ_q.csv")
knitr::opts_chunk$set(echo = TRUE)
res.ca = CA(TT_occ_q, ncp = 4, graph = FALSE)
#contribution of any therm
mat_terms_contrib = as.data.frame(res.ca$col$contrib)
mat_terms_contrib_order = mat_terms_contrib[order(-mat_terms_contrib$`Dim 1`,
-mat_terms_contrib$`Dim 2`,
-mat_terms_contrib$`Dim 3`),]
n_top_terms = 20
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
mat_terms_contrib = as.data.frame(res.ca$col$contrib)
mat_terms_contrib_order = mat_terms_contrib[order(-mat_terms_contrib$`Dim 1`,
-mat_terms_contrib$`Dim 2`,
-mat_terms_contrib$`Dim 3`),]
n_top_terms = 20
# mat coord terms
mat_coord_col = res.ca$col$coord
vect_index_top = c(order(-mat_terms_contrib$`Dim 1`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 2`)[1:n_top_terms],
order(-mat_terms_contrib$`Dim 3`)[1:n_top_terms])
unique_vect_index_top = unique(vect_index_top)
mat_coord_col_top = mat_coord_col[unique_vect_index_top, 1:2]
plot(mat_coord_col_top)
# mat coord topics
mat_coord_row = res.ca$row$coord
mat_coord_row_ = mat_coord_row[,1:2]
points(mat_coord_row_, col= 'red')
mat_coord_col_top = as.data.frame(mat_coord_col_top)
mat_coord_row_    = as.data.frame(mat_coord_row_)
mat_coord_col_top$type = "terms"
mat_coord_row_$type = "topics"
all_coord = rbind(mat_coord_col_top,mat_coord_row_ )
all_coord$type = as.factor(all_coord$type)
levels(all_coord$type)<-c(1,2)
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+theme(legend.position = "none")
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
+ theme(legend.position = "none")
set.seed(42)
p <- ggplot(all_coord, aes(`Dim 1`, `Dim 2`)) +
geom_point(color =factor(all_coord$type)) +
theme_classic(base_size = 5)
p = p + geom_label_repel(aes(label = rownames(all_coord),
fill = factor(type)), color = 'black', size = 3)
p=p+ theme(legend.position = "none")
p = p +  xlab("Dim1") + ylab("Dim2")
p <- p +scale_fill_manual(values=c('#FFCCCC',"#0066FF","#FF0000",'#009999'))
p
